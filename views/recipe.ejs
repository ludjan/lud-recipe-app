<!DOCTYPE html>
<html>
    <head>
        <title>Recipe - <%= data.name %></title>
    </head>
    <body>
        <h1> <%= data.name %> (<%= data.id %>)</h1>
        <div> <%= data.description %> </div>
        <div> <%= data.created_on %> </div>
        
        <button type="edit" id="edit-recipe-btn">EDIT</button>
        <button type="delete" id="delete-recipe-btn">DELETE</button>

        <script src="/static/js/recipe.js"></script>
        <script type="text/javascript">
            
            var recipeId= '<%= data.id %>'
            const deleteBtn = document.getElementById('delete-recipe-btn')
            const editBtn = document.getElementById('edit-recipe-btn')

            deleteBtn.addEventListener("click", () => {
                deleteRecipe(recipeId).then(
                    window.location.pathname = ('/..') // navigates user back to main page
                )
            })

            editBtn.addEventListener("click", () => {
                window.location.pathname = ('/../edit/' + recipeId)
            })

            async function deleteRecipe(recipeId) {
                const url = "https://lud-recipe-api.herokuapp.com/api/recipes/" + recipeId
                const config = {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }
                fetch(url, config)
            }
            
        </script>
    </body>
</html>